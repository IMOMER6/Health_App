{"dependencies":[{"name":"../api/client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":36,"index":36}}],"key":"vrY6iF+Nd2CrRu9d6eBxeX1BPiA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.uploadToBackend = uploadToBackend;\n  var _apiClient = require(_dependencyMap[0], \"../api/client\");\n  function toIngestSamples(samples) {\n    return samples.map(s => {\n      const timestamp = s.timestamp.toISOString();\n      if (s.type === \"blood_glucose\") {\n        return {\n          type: \"blood_glucose\",\n          timestamp,\n          data: s.data\n        };\n      }\n      if (s.type === \"heart_rate\") {\n        return {\n          type: \"heart_rate\",\n          timestamp,\n          data: s.data\n        };\n      }\n      if (s.type === \"blood_pressure\") {\n        return {\n          type: \"blood_pressure\",\n          timestamp,\n          data: s.data\n        };\n      }\n      if (s.type === \"steps\") {\n        return {\n          type: \"steps\",\n          timestamp,\n          data: s.data\n        };\n      }\n      if (s.type === \"exercise_minutes\") {\n        return {\n          type: \"exercise_minutes\",\n          timestamp,\n          data: s.data\n        };\n      }\n      return {\n        type: \"ecg\",\n        timestamp,\n        data: s.data\n      };\n    });\n  }\n  async function uploadToBackend(opts) {\n    if (opts.storageMode === \"local_only\") {\n      return {\n        uploaded: 0,\n        skipped: opts.samples.length\n      };\n    }\n    const payload = {\n      user_id: opts.userId,\n      storage_mode: opts.storageMode,\n      samples: toIngestSamples(opts.samples)\n    };\n    const res = await _apiClient.api.post(\"/samples\", payload);\n    return {\n      uploaded: res.data.inserted,\n      skipped: opts.samples.length - res.data.inserted\n    };\n  }\n});","lineCount":72,"map":[[7,2,28,0,"exports"],[7,9,28,0],[7,10,28,0,"uploadToBackend"],[7,25,28,0],[7,28,28,0,"uploadToBackend"],[7,43,28,0],[8,2,1,0],[8,6,1,0,"_apiClient"],[8,16,1,0],[8,19,1,0,"require"],[8,26,1,0],[8,27,1,0,"_dependencyMap"],[8,41,1,0],[9,2,5,0],[9,11,5,9,"toIngestSamples"],[9,26,5,24,"toIngestSamples"],[9,27,5,25,"samples"],[9,34,5,48],[9,36,5,66],[10,4,6,2],[10,11,6,9,"samples"],[10,18,6,16],[10,19,6,17,"map"],[10,22,6,20],[10,23,6,22,"s"],[10,24,6,23],[10,28,6,28],[11,6,7,4],[11,12,7,10,"timestamp"],[11,21,7,19],[11,24,7,22,"s"],[11,25,7,23],[11,26,7,24,"timestamp"],[11,35,7,33],[11,36,7,34,"toISOString"],[11,47,7,45],[11,48,7,46],[11,49,7,47],[12,6,9,4],[12,10,9,8,"s"],[12,11,9,9],[12,12,9,10,"type"],[12,16,9,14],[12,21,9,19],[12,36,9,34],[12,38,9,36],[13,8,10,6],[13,15,10,13],[14,10,10,15,"type"],[14,14,10,19],[14,16,10,21],[14,31,10,36],[15,10,10,38,"timestamp"],[15,19,10,47],[16,10,10,49,"data"],[16,14,10,53],[16,16,10,55,"s"],[16,17,10,56],[16,18,10,57,"data"],[17,8,10,62],[17,9,10,63],[18,6,11,4],[19,6,12,4],[19,10,12,8,"s"],[19,11,12,9],[19,12,12,10,"type"],[19,16,12,14],[19,21,12,19],[19,33,12,31],[19,35,12,33],[20,8,13,6],[20,15,13,13],[21,10,13,15,"type"],[21,14,13,19],[21,16,13,21],[21,28,13,33],[22,10,13,35,"timestamp"],[22,19,13,44],[23,10,13,46,"data"],[23,14,13,50],[23,16,13,52,"s"],[23,17,13,53],[23,18,13,54,"data"],[24,8,13,59],[24,9,13,60],[25,6,14,4],[26,6,15,4],[26,10,15,8,"s"],[26,11,15,9],[26,12,15,10,"type"],[26,16,15,14],[26,21,15,19],[26,37,15,35],[26,39,15,37],[27,8,16,6],[27,15,16,13],[28,10,16,15,"type"],[28,14,16,19],[28,16,16,21],[28,32,16,37],[29,10,16,39,"timestamp"],[29,19,16,48],[30,10,16,50,"data"],[30,14,16,54],[30,16,16,56,"s"],[30,17,16,57],[30,18,16,58,"data"],[31,8,16,63],[31,9,16,64],[32,6,17,4],[33,6,18,4],[33,10,18,8,"s"],[33,11,18,9],[33,12,18,10,"type"],[33,16,18,14],[33,21,18,19],[33,28,18,26],[33,30,18,28],[34,8,19,6],[34,15,19,13],[35,10,19,15,"type"],[35,14,19,19],[35,16,19,21],[35,23,19,28],[36,10,19,30,"timestamp"],[36,19,19,39],[37,10,19,41,"data"],[37,14,19,45],[37,16,19,47,"s"],[37,17,19,48],[37,18,19,49,"data"],[38,8,19,54],[38,9,19,55],[39,6,20,4],[40,6,21,4],[40,10,21,8,"s"],[40,11,21,9],[40,12,21,10,"type"],[40,16,21,14],[40,21,21,19],[40,39,21,37],[40,41,21,39],[41,8,22,6],[41,15,22,13],[42,10,22,15,"type"],[42,14,22,19],[42,16,22,21],[42,34,22,39],[43,10,22,41,"timestamp"],[43,19,22,50],[44,10,22,52,"data"],[44,14,22,56],[44,16,22,58,"s"],[44,17,22,59],[44,18,22,60,"data"],[45,8,22,65],[45,9,22,66],[46,6,23,4],[47,6,24,4],[47,13,24,11],[48,8,24,13,"type"],[48,12,24,17],[48,14,24,19],[48,19,24,24],[49,8,24,26,"timestamp"],[49,17,24,35],[50,8,24,37,"data"],[50,12,24,41],[50,14,24,43,"s"],[50,15,24,44],[50,16,24,45,"data"],[51,6,24,50],[51,7,24,51],[52,4,25,2],[52,5,25,3],[52,6,25,4],[53,2,26,0],[54,2,28,7],[54,17,28,22,"uploadToBackend"],[54,32,28,37,"uploadToBackend"],[54,33,28,38,"opts"],[54,37,32,1],[54,39,32,3],[55,4,33,2],[55,8,33,6,"opts"],[55,12,33,10],[55,13,33,11,"storageMode"],[55,24,33,22],[55,29,33,27],[55,41,33,39],[55,43,33,41],[56,6,34,4],[56,13,34,11],[57,8,34,13,"uploaded"],[57,16,34,21],[57,18,34,23],[57,19,34,24],[58,8,34,26,"skipped"],[58,15,34,33],[58,17,34,35,"opts"],[58,21,34,39],[58,22,34,40,"samples"],[58,29,34,47],[58,30,34,48,"length"],[59,6,34,55],[59,7,34,56],[60,4,35,2],[61,4,37,2],[61,10,37,8,"payload"],[61,17,37,15],[61,20,37,18],[62,6,38,4,"user_id"],[62,13,38,11],[62,15,38,13,"opts"],[62,19,38,17],[62,20,38,18,"userId"],[62,26,38,24],[63,6,39,4,"storage_mode"],[63,18,39,16],[63,20,39,18,"opts"],[63,24,39,22],[63,25,39,23,"storageMode"],[63,36,39,34],[64,6,40,4,"samples"],[64,13,40,11],[64,15,40,13,"toIngestSamples"],[64,30,40,28],[64,31,40,29,"opts"],[64,35,40,33],[64,36,40,34,"samples"],[64,43,40,41],[65,4,41,2],[65,5,41,3],[66,4,43,2],[66,10,43,8,"res"],[66,13,43,11],[66,16,43,14],[66,22,43,20,"api"],[66,32,43,23],[66,33,43,23,"api"],[66,36,43,23],[66,37,43,24,"post"],[66,41,43,28],[66,42,43,51],[66,52,43,61],[66,54,43,63,"payload"],[66,61,43,70],[66,62,43,71],[67,4,44,2],[67,11,44,9],[68,6,44,11,"uploaded"],[68,14,44,19],[68,16,44,21,"res"],[68,19,44,24],[68,20,44,25,"data"],[68,24,44,29],[68,25,44,30,"inserted"],[68,33,44,38],[69,6,44,40,"skipped"],[69,13,44,47],[69,15,44,49,"opts"],[69,19,44,53],[69,20,44,54,"samples"],[69,27,44,61],[69,28,44,62,"length"],[69,34,44,68],[69,37,44,71,"res"],[69,40,44,74],[69,41,44,75,"data"],[69,45,44,79],[69,46,44,80,"inserted"],[70,4,44,89],[70,5,44,90],[71,2,45,0],[72,0,45,1],[72,3]],"functionMap":{"names":["<global>","toIngestSamples","samples.map$argument_0","uploadToBackend"],"mappings":"AAA;ACI;qBCC;GDmB;CDC;OGE;CHiB"},"hasCjsExports":false},"type":"js/module"}]}