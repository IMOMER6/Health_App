{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"../api/client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":36,"index":36}}],"key":"vrY6iF+Nd2CrRu9d6eBxeX1BPiA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.uploadToBackend = uploadToBackend;\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _apiClient = require(_dependencyMap[1], \"../api/client\");\n  function toIngestSamples(samples) {\n    return samples.map(s => {\n      var timestamp = s.timestamp.toISOString();\n      if (s.type === \"blood_glucose\") {\n        return {\n          type: \"blood_glucose\",\n          timestamp,\n          data: s.data\n        };\n      }\n      if (s.type === \"heart_rate\") {\n        return {\n          type: \"heart_rate\",\n          timestamp,\n          data: s.data\n        };\n      }\n      if (s.type === \"blood_pressure\") {\n        return {\n          type: \"blood_pressure\",\n          timestamp,\n          data: s.data\n        };\n      }\n      if (s.type === \"steps\") {\n        return {\n          type: \"steps\",\n          timestamp,\n          data: s.data\n        };\n      }\n      if (s.type === \"exercise_minutes\") {\n        return {\n          type: \"exercise_minutes\",\n          timestamp,\n          data: s.data\n        };\n      }\n      return {\n        type: \"ecg\",\n        timestamp,\n        data: s.data\n      };\n    });\n  }\n  function uploadToBackend(_x) {\n    return _uploadToBackend.apply(this, arguments);\n  }\n  function _uploadToBackend() {\n    _uploadToBackend = (0, _asyncToGenerator.default)(function* (opts) {\n      if (opts.storageMode === \"local_only\") {\n        return {\n          uploaded: 0,\n          skipped: opts.samples.length\n        };\n      }\n      var payload = {\n        user_id: opts.userId,\n        storage_mode: opts.storageMode,\n        samples: toIngestSamples(opts.samples)\n      };\n      var res = yield _apiClient.api.post(\"/samples\", payload);\n      return {\n        uploaded: res.data.inserted,\n        skipped: opts.samples.length - res.data.inserted\n      };\n    });\n    return _uploadToBackend.apply(this, arguments);\n  }\n});","lineCount":85,"map":[[12,2,28,0,"exports"],[12,9,28,0],[12,10,28,0,"uploadToBackend"],[12,25,28,0],[12,28,28,0,"uploadToBackend"],[12,43,28,0],[13,2,45,1],[13,6,45,1,"_babelRuntimeHelpersAsyncToGenerator"],[13,42,45,1],[13,45,45,1,"require"],[13,52,45,1],[13,53,45,1,"_dependencyMap"],[13,67,45,1],[14,2,45,1],[14,6,45,1,"_asyncToGenerator"],[14,23,45,1],[14,26,45,1,"_interopDefault"],[14,41,45,1],[14,42,45,1,"_babelRuntimeHelpersAsyncToGenerator"],[14,78,45,1],[15,2,1,0],[15,6,1,0,"_apiClient"],[15,16,1,0],[15,19,1,0,"require"],[15,26,1,0],[15,27,1,0,"_dependencyMap"],[15,41,1,0],[16,2,5,0],[16,11,5,9,"toIngestSamples"],[16,26,5,24,"toIngestSamples"],[16,27,5,25,"samples"],[16,34,5,48],[16,36,5,66],[17,4,6,2],[17,11,6,9,"samples"],[17,18,6,16],[17,19,6,17,"map"],[17,22,6,20],[17,23,6,22,"s"],[17,24,6,23],[17,28,6,28],[18,6,7,4],[18,10,7,10,"timestamp"],[18,19,7,19],[18,22,7,22,"s"],[18,23,7,23],[18,24,7,24,"timestamp"],[18,33,7,33],[18,34,7,34,"toISOString"],[18,45,7,45],[18,46,7,46],[18,47,7,47],[19,6,9,4],[19,10,9,8,"s"],[19,11,9,9],[19,12,9,10,"type"],[19,16,9,14],[19,21,9,19],[19,36,9,34],[19,38,9,36],[20,8,10,6],[20,15,10,13],[21,10,10,15,"type"],[21,14,10,19],[21,16,10,21],[21,31,10,36],[22,10,10,38,"timestamp"],[22,19,10,47],[23,10,10,49,"data"],[23,14,10,53],[23,16,10,55,"s"],[23,17,10,56],[23,18,10,57,"data"],[24,8,10,62],[24,9,10,63],[25,6,11,4],[26,6,12,4],[26,10,12,8,"s"],[26,11,12,9],[26,12,12,10,"type"],[26,16,12,14],[26,21,12,19],[26,33,12,31],[26,35,12,33],[27,8,13,6],[27,15,13,13],[28,10,13,15,"type"],[28,14,13,19],[28,16,13,21],[28,28,13,33],[29,10,13,35,"timestamp"],[29,19,13,44],[30,10,13,46,"data"],[30,14,13,50],[30,16,13,52,"s"],[30,17,13,53],[30,18,13,54,"data"],[31,8,13,59],[31,9,13,60],[32,6,14,4],[33,6,15,4],[33,10,15,8,"s"],[33,11,15,9],[33,12,15,10,"type"],[33,16,15,14],[33,21,15,19],[33,37,15,35],[33,39,15,37],[34,8,16,6],[34,15,16,13],[35,10,16,15,"type"],[35,14,16,19],[35,16,16,21],[35,32,16,37],[36,10,16,39,"timestamp"],[36,19,16,48],[37,10,16,50,"data"],[37,14,16,54],[37,16,16,56,"s"],[37,17,16,57],[37,18,16,58,"data"],[38,8,16,63],[38,9,16,64],[39,6,17,4],[40,6,18,4],[40,10,18,8,"s"],[40,11,18,9],[40,12,18,10,"type"],[40,16,18,14],[40,21,18,19],[40,28,18,26],[40,30,18,28],[41,8,19,6],[41,15,19,13],[42,10,19,15,"type"],[42,14,19,19],[42,16,19,21],[42,23,19,28],[43,10,19,30,"timestamp"],[43,19,19,39],[44,10,19,41,"data"],[44,14,19,45],[44,16,19,47,"s"],[44,17,19,48],[44,18,19,49,"data"],[45,8,19,54],[45,9,19,55],[46,6,20,4],[47,6,21,4],[47,10,21,8,"s"],[47,11,21,9],[47,12,21,10,"type"],[47,16,21,14],[47,21,21,19],[47,39,21,37],[47,41,21,39],[48,8,22,6],[48,15,22,13],[49,10,22,15,"type"],[49,14,22,19],[49,16,22,21],[49,34,22,39],[50,10,22,41,"timestamp"],[50,19,22,50],[51,10,22,52,"data"],[51,14,22,56],[51,16,22,58,"s"],[51,17,22,59],[51,18,22,60,"data"],[52,8,22,65],[52,9,22,66],[53,6,23,4],[54,6,24,4],[54,13,24,11],[55,8,24,13,"type"],[55,12,24,17],[55,14,24,19],[55,19,24,24],[56,8,24,26,"timestamp"],[56,17,24,35],[57,8,24,37,"data"],[57,12,24,41],[57,14,24,43,"s"],[57,15,24,44],[57,16,24,45,"data"],[58,6,24,50],[58,7,24,51],[59,4,25,2],[59,5,25,3],[59,6,25,4],[60,2,26,0],[61,2,26,1],[61,11,28,22,"uploadToBackend"],[61,26,28,37,"uploadToBackend"],[61,27,28,37,"_x"],[61,29,28,37],[62,4,28,37],[62,11,28,37,"_uploadToBackend"],[62,27,28,37],[62,28,28,37,"apply"],[62,33,28,37],[62,40,28,37,"arguments"],[62,49,28,37],[63,2,28,37],[64,2,28,37],[64,11,28,37,"_uploadToBackend"],[64,28,28,37],[65,4,28,37,"_uploadToBackend"],[65,20,28,37],[65,27,28,37,"_asyncToGenerator"],[65,44,28,37],[65,45,28,37,"default"],[65,52,28,37],[65,54,28,7],[65,65,28,38,"opts"],[65,69,32,1],[65,71,32,3],[66,6,33,2],[66,10,33,6,"opts"],[66,14,33,10],[66,15,33,11,"storageMode"],[66,26,33,22],[66,31,33,27],[66,43,33,39],[66,45,33,41],[67,8,34,4],[67,15,34,11],[68,10,34,13,"uploaded"],[68,18,34,21],[68,20,34,23],[68,21,34,24],[69,10,34,26,"skipped"],[69,17,34,33],[69,19,34,35,"opts"],[69,23,34,39],[69,24,34,40,"samples"],[69,31,34,47],[69,32,34,48,"length"],[70,8,34,55],[70,9,34,56],[71,6,35,2],[72,6,37,2],[72,10,37,8,"payload"],[72,17,37,15],[72,20,37,18],[73,8,38,4,"user_id"],[73,15,38,11],[73,17,38,13,"opts"],[73,21,38,17],[73,22,38,18,"userId"],[73,28,38,24],[74,8,39,4,"storage_mode"],[74,20,39,16],[74,22,39,18,"opts"],[74,26,39,22],[74,27,39,23,"storageMode"],[74,38,39,34],[75,8,40,4,"samples"],[75,15,40,11],[75,17,40,13,"toIngestSamples"],[75,32,40,28],[75,33,40,29,"opts"],[75,37,40,33],[75,38,40,34,"samples"],[75,45,40,41],[76,6,41,2],[76,7,41,3],[77,6,43,2],[77,10,43,8,"res"],[77,13,43,11],[77,22,43,20,"api"],[77,32,43,23],[77,33,43,23,"api"],[77,36,43,23],[77,37,43,24,"post"],[77,41,43,28],[77,42,43,51],[77,52,43,61],[77,54,43,63,"payload"],[77,61,43,70],[77,62,43,71],[78,6,44,2],[78,13,44,9],[79,8,44,11,"uploaded"],[79,16,44,19],[79,18,44,21,"res"],[79,21,44,24],[79,22,44,25,"data"],[79,26,44,29],[79,27,44,30,"inserted"],[79,35,44,38],[80,8,44,40,"skipped"],[80,15,44,47],[80,17,44,49,"opts"],[80,21,44,53],[80,22,44,54,"samples"],[80,29,44,61],[80,30,44,62,"length"],[80,36,44,68],[80,39,44,71,"res"],[80,42,44,74],[80,43,44,75,"data"],[80,47,44,79],[80,48,44,80,"inserted"],[81,6,44,89],[81,7,44,90],[82,4,45,0],[82,5,45,1],[83,4,45,1],[83,11,45,1,"_uploadToBackend"],[83,27,45,1],[83,28,45,1,"apply"],[83,33,45,1],[83,40,45,1,"arguments"],[83,49,45,1],[84,2,45,1],[85,0,45,1],[85,3]],"functionMap":{"names":["<global>","toIngestSamples","samples.map$argument_0","uploadToBackend"],"mappings":"AAA;ACI;qBCC;GDmB;CDC;OGE;CHiB"},"hasCjsExports":false},"type":"js/module"}]}